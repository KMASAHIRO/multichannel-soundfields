study:
  study_name: naf_optuna_study        # Optuna study name
  direction: minimize                # objective direction
  n_trials: 50                       # number of trials
  sampler: tpe                       # sampler type (tpe / random / cmaes)

doa_metric:
  algorithm: NormMUSIC               # metric
  fallback_value: 999.0              # value used if metric is missing

training_fixed:
  # === runtime / training control ===
  gpus: 4                            # number of GPUs
  epochs: 200                        # total epochs
  resume: 0                          # resume flag
  batch_size: 20                     # batch size

  # === loss weights (fixed only) ===
  mag_alpha: 1.0                     # magnitude loss scale

  # === optimization (fixed part only) ===
  weight_decay_grid: 1.0e-2          # weight decay for grid parameters
  weight_decay_main: 0.0             # weight decay for non-grid parameters

  # === data / sampling (fixed only) ===
  pixel_count: 2000                  # number of pixels per forward

  # === network / architecture (fixed only) ===
  grid_features: 64                  # grid feature dimension
  dir_ch: 4                          # number of direction channels

  # === normalization / activation ===
  batch_norm: none                   # batch norm type
  activation_func_name: default      # activation function preset

  # === grid / kernel parameters (fixed only) ===
  grid_gap: 0.25                     # grid spacing
  bandwith_init: 0.25                # initial grid bandwidth
  position_float: 0.1                # grid position float range
  min_bandwidth: 0.1                 # minimum bandwidth
  max_bandwidth: 0.5                 # maximum bandwidth

  # === embedding (embedding_module_log) ===
  embed_xyz_num_freqs: 10                # number of frequencies for xyz embeddings
  embed_xyz_max_freq: 7              # max_freq for xyz embedding
  embed_time_num_freqs: 10                # number of frequencies for time embeddings
  embed_time_max_freq: 10            # max_freq for time embedding
  embed_freq_num_freqs: 10                # number of frequencies for frequency embeddings
  embed_freq_max_freq: 10            # max_freq for frequency embedding

  # === saving ===
  save_best_k: 10                    # keep top-k checkpoints

search_space:
  layers:
    type: int
    low: 4
    high: 12

  layers_residual:
    type: int
    low: 0
    high: 3

  features:
    type: categorical
    choices: [64, 128, 256, 512, 1024]

  reg_eps:
    type: float
    low: 0.0
    high: 0.2

  pixel_count:
    type: int
    low: 200
    high: 4000

  lr_init:
    type: float
    low: 1.0e-5
    high: 1.0e-2
    log: true

  lr_decay:
    type: float
    low: 5.0e-2
    high: 5.0e-1
    log: true

  phase_alpha:
    type: float
    low: 0.1
    high: 10.0
